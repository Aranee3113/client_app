<script setup>
definePageMeta({
  layout: "member",
});

import { ref, onMounted } from "vue";
import { useRoute } from "vue-router";

const { $axios, $config } = useNuxtApp();

const products = ref([]);
const posts = ref([]);
const route = useRoute();
const loading = ref(true);
const error = ref("");
const userId = route.params.id;

const fetchProducts = async () => {
  try {
    const res = await $axios.get("/product");
    if (res.status === 200) {
      products.value = res.data.data;
    }
  } catch (error) {
    console.error("โหลดข้อมูลผ้าล้มเหลว", error);
  }
};

const normalizeImages = (raw) => {
  if (!raw) return [];
  if (Array.isArray(raw)) return raw;
  try {
    const parsed = typeof raw === "string" ? JSON.parse(raw) : raw;
    return Array.isArray(parsed) ? parsed : [];
  } catch {
    return [];
  }
};

const fetchPosts = async () => {
  loading.value = true;
  error.value = "";
  try {
    const res = await $axios.get("/post");
    const rows = res.data?.data || [];
    posts.value = rows.map((p) => ({
      ...p,
      images: normalizeImages(p.images),
    }));
  } catch (e) {
    console.error("โหลดข้อมูลโพสต์ล้มเหลว", e);
    error.value = "ไม่สามารถโหลดโพสต์ได้";
  } finally {
    loading.value = false;
  }
};

onMounted(() => {
  fetchProducts();
  fetchPosts();
});
</script>

<template>
  <div
    class="min-h-screen bg-gradient-to-br from-[#bf9fdf] via-white to-[#e8c9ad] py-12 md:py-16 px-4 sm:px-6 lg:px-8"
  >
    <!-- ปุ่มกลับด้านบน -->
    <CommonButtonBack class="mb-6" />

    <div class="mx-auto w-full max-w-6xl space-y-10 md:space-y-12">
      <!-- หัวข้อหลัก -->
      <header class="text-center">
        <h1
          class="text-3xl md:text-4xl font-extrabold text-gray-800 dark:text-white tracking-tight"
        >
          วัฒนธรรมผ้าทอมือ
        </h1>
      </header>

      <!-- กล่องเนื้อหา -->
      <section
        class="text-base md:text-xl leading-relaxed text-gray-700 dark:text-gray-300 bg-white/80 dark:bg-gray-900/60 backdrop-blur-sm p-5 md:p-10 rounded-2xl shadow-md space-y-8"
      >
        <!-- หัวข้อย่อยหลัก -->
        <h2
          id="intro"
          class="text-2xl md:text-3xl font-extrabold text-purple-800 dark:text-white"
        >
          ผ้าทอมือ
        </h2>

        <!-- บริบทและความหมาย -->

        <p class="text-justify indent-8">
          เป็นวัฒนธรรมในหมวดหมู่ของกิจกรรมเพื่อการยังชีพภายใต้ความต้องการปัจจัยสี่เพื่อการดำรงชีวิตและสืบทอดเผ่าพันธุ์
          และเนื่องจากการทอผ้าเป็นวัฒนธรรมเพื่อการดำรงอยู่ของชีวิตมนุษย์
          ดังนั้นจึงเกี่ยวพันธุ์และมีมิติรอบด้านอย่างลึกซึ้ง
          เกี่ยวพันธุ์กับนิเวศวิทยาโดยเป็นส่วนหนึ่งของนิเวศวิทยาวัฒนธรรม
          เรียกนิเวศวิทยาวัฒนธรรมการทอผ้าซึ่งจะเกี่ยวข้องกับการนำนิเวศวิทยาด้านสิ่งแวดล้อมๆ
          มาสร้างเครื่องมือในการทอผ้า มาเป็นแรงบันดาลใจในการออกแบบลวดลายผ้า
          ออกแบบการใช้ผ้าให้เหมาะกับนิเวศของแต่ละพื้นที่
          การทำผ้าและกระบวนการทอผ้าเข้าไปใช้ในพิธีกรรมต่างๆ อย่างแยบยล เป็นต้น
          ดั้งนั้นผ้าทอมือจึงให้ความหมายมากกว่าการเป็นเครื่องนุ่งห่ม
        </p>

        <!-- การแต่งงาน -->
        <h3
          id="marriage"
          class="text-xl md:text-2xl font-bold text-purple-700 dark:text-purple-300"
        >
          วัฒนธรรมการแต่งงาน
        </h3>
        <p class="text-justify indent-8">
          การแต่งงานในสังคมชนบทเป็นการสร้างครอบครัวใหม่ ดังนั้น
          พิธีกรรมตามวัฒนธรรมจึงล้วนแล้วแต่ให้ความหมายในด้านการสร้าง การเติบโต
          การเจริญรุ่งเรือง การให้กำลังใจ ให้ต้นทุนชีวิต
          และให้ความคาดหวังว่าจะต้องพบสิ่งที่ดีงามในอนาคต
          วัฒนธรรมการแต่งงานของชาติพันธุ์เขมรจะใช้ผ้าทอมือในกิจกรรมหลายๆ
          ส่วนด้วยกันคือ
        </p>
        <ol class="list-decimal list-inside indent-8 space-y-4 text-justify">
          <li>
            ในส่วนเครื่องเซ่นไหว้เพื่อบอกกล่าวบรรพบุรุษที่ล่วงลับ ผีบ้านผีเรือน
            จะใช้ผ้าผู้หญิง ผ้าผู้ชาย ประกอบด้วยผ้านุ่ง ผ้าสไบ ผ้าโสร่ง
            และผ้าขาวม้า พร้อม หมาก พลู ขันธ์ 5 ให้ความหมาย
          </li>
          <li>ในส่วนของผ้าไหว้ หรือเครื่องสมมา เขมรเรียก เกรืองสะมา</li>
          <li>ในส่วนของเครื่องแต่งกายของเจ้าบ่าว เจ้าสาว</li>
          <li>ในส่วนของเครื่องแต่งกายผู้ร่วมงาน</li>
        </ol>

        <!-- การเกิด -->
        <h3
          id="birth"
          class="text-xl md:text-2xl font-bold text-purple-700 dark:text-purple-300"
        >
          วัฒนธรรมการเกิด
        </h3>
        <p class="text-justify indent-8">
          วัฒนธรรมเกี่ยวกับการเกิด ในอดีตการคลอดอยู่ในการดูแลของหมอตำแย
          ครอบครัวจัดเครื่องไหว้ยกครูเพื่อความราบรื่น ประกอบด้วยผ้าขาว ขันธ์ห้า
          และเงินตามที่ครูสืบทอด (เดิมราวหกสลึง–หกบาท ปัจจุบันแล้วแต่เจ้าของไข้)
          พิธีนี้สะท้อนการใช้ผ้าที่ตนผลิตอย่างคุ้มค่าและเป็นส่วนหนึ่งของเครื่องบูชาประจำพิธี
        </p>
        <p class="text-justify indent-8">
          ผ้านุ่ง ผ้าโสร่ง หรือผ้าเก่าของแม่ยังใช้เป็นผ้าอ้อมได้ดี เพราะนุ่ม
          ซับน้ำได้มาก และสิ่งตกค้างจากแป้งหรือเส้นใยเล็กถูกซักออกจนหมด
          ลดการระคายผิวทารก อีกทั้งกลิ่นพ่อแม่ช่วยให้เด็กรู้สึกใกล้ชิด อบอุ่น
          และลดความกังวล
        </p>

        <!-- การศึกษาและการเรียนรู้ -->
        <h3
          id="learning"
          class="text-xl md:text-2xl font-bold text-purple-700 dark:text-purple-300"
        >
          การศึกษาและการเรียนรู้
        </h3>
        <p class="text-justify indent-8">
          วัฒนธรรมเกี่ยวกับการศึกษาและการเรียนรู้
          ชาวเขมรนับถือผีบรรพบุรุษแนบแน่น
          กิจกรรมสำคัญจึงมักมีการกรวดน้ำหรือบอกกล่าวเสมอ ก่อนเรียนรู้งานใหม่
          เช่น การทอลายใหม่ จะทำพิธีบูชาครูด้วยขันธ์ห้าและผ้าขาว
          พร้อมชุดผ้าหญิง–ชายครบ แม้ดูเรียบง่าย แต่ช่วยให้ผู้ทำมีสมาธิ สติ
          เป้าหมายชัด เกิดการวางแผนและทำงานอย่างเป็นขั้นตอน จนนำไปสู่ความสำเร็จ
        </p>

        <!-- การแต่งกายและการใช้ผ้า -->
        <h3
          id="dress"
          class="text-xl md:text-2xl font-bold text-purple-700 dark:text-purple-300"
        >
          การแต่งกายและการใช้ผ้า
        </h3>
        <p class="text-justify indent-8">
          วัฒนธรรมเกี่ยวการแต่งกาย
          การนุ่งผ้าทอมือที่ผลิตเองสอดคล้องวิถีชีวิตและนิเวศการผลิต
          เคารพกาลเทศะและฐานะทางสังคม ใช้อย่างประหยัดและสร้างสรรค์
          โครงสร้างผ้าผืน 4–8 ศอก นุ่งได้หลายแบบ แบ่งใหญ่เป็น “นุ่งลอยชาย”
          สำหรับใช้ทั่วไป และ “นุ่งโจง” เมื่อต้องการคล่องตัว เช่น
          ทำเกษตรหรือปีนต้นไม้ ผ้าขนาดประมาณ 70×200 ซม. จะนุ่งโจงได้กระชับ
          ส่วนในโอกาสพิเศษ อาจนุ่งลอยชายรุ่มรามหรือโจงยาวเบาสบาย
          เติมสไบ/เครื่องประดับเพื่อยกระดับความงาม
        </p>

        <!-- วัสดุและเส้นใย -->
        <h3
          id="materials"
          class="text-xl md:text-2xl font-bold text-purple-700 dark:text-purple-300"
        >
          วัสดุและเส้นใย
        </h3>
        <p class="text-justify indent-8">
          นอกเหนือจากรูปแบบการนุ่ง วัตถุดิบก็ชี้นำโอกาสใช้ผ้าเช่นกัน
          งานกลางแจ้งและงานบ้านนิยมฝ้าย เพราะซับเหงื่อ ระบายอากาศดี
          และเหนียวขึ้นเมื่อเปียก ส่วนงานพิเศษนิยมไหม เพราะใยยาว ละเอียด เงางาม
          ผิวเรียบ เหมาะกับงานที่ต้องการความประณีต
        </p>

        <!-- ลวดลายและความหมาย -->
        <h3
          id="patterns"
          class="text-xl md:text-2xl font-bold text-purple-700 dark:text-purple-300"
        >
          ลวดลายและความหมาย
        </h3>
        <p class="text-justify indent-8">
          การออกแบบลวดลายพื้นบ้านผ่านการคิดวิเคราะห์ให้สอดคล้องวิถีและประเพณี
          ลายพื้น ลายทาง ลายตาราง เหมาะใช้ทั่วไป ขณะที่มัดหมี่ ยกดอก ยกขิด
          หรือเทคนิคซับซ้อน ใช้ในโอกาสสำคัญเพราะต้องใช้เวลาและองค์ความรู้มาก
          แบบแผนนี้ทำให้สังคมให้ “คุณค่า” ตามความยากง่ายของงานและภูมิปัญญา
          เคารพผู้รู้หรือ “ปราชญ์” (อาจารย์/กรู/หลูกกูร)
          บทบาทผ้าทอมือจึงเกินกว่าความเป็นเครื่องนุ่งห่ม
        </p>

        <!-- การตาย -->
        <h3
          id="death"
          class="text-xl md:text-2xl font-bold text-purple-700 dark:text-purple-300"
        >
          วัฒนธรรมการตาย
        </h3>
        <p class="text-justify indent-8">
          วัฒนธรรมเกี่ยวกับการตาย เชื่อว่าผู้ตายไปสู่อีกภพหนึ่ง
          จึงเตรียมปัจจัยสี่ โดยเฉพาะเสื้อผ้า นิยมใส่ผ้า 4 ผืนของหญิง–ชาย
          เผื่อคู่ผู้ตายในโลกหน้า บางท้องถิ่นถวายทำบุญกับพระ หรือใส่ลงโลง
          (กรณีฝังแบบโบราณ) ก่อนขุดกระดูกทำบุญภายหลัง
          ซึ่งสอดคล้องกับข้อมูลพื้นที่ป่าช้า
          และหลักฐานโบราณคดีที่พบเศษผ้ากับเครื่องประดับ
          ผ้าทอมือจึงผูกพันพิธีตายมาเนิ่นนาน
          เป็นสื่อแห่งความรักและเมตตาระหว่างคนกับสังคม
          เสริมพลังชุมชนด้วยภูมิปัญญาของตนเอง
        </p>

        <!-- สรุปภาพรวม -->
        <h2
          id="summary"
          class="text-2xl md:text-3xl font-extrabold text-purple-800 dark:text-white"
        >
          สรุปภาพรวม
        </h2>
        <p class="text-justify indent-8">
          ผ้าทอมือนั้น เป็นเครื่องมือที่มีความหมาย ยิ่งต่อการพัฒนาศักยภาพของคน
          พัฒนาความสุขและความเข้มแข็งของสังคมชุมชน
          พัฒนารายได้เข้าครอบครัวอย่างสม่ำเสมอและเป็นอิสระยิ่ง
          ไม่ต้องเป็นลูกจ้างใคร ตราบเท่าที่คนทอผ้าจะพัฒนาตนเองเองได้
          ยิ่งพัฒนาตัวเองได้มากเท่าไหร่ รายได้ก็เพิ่มมากขึ้นเท่านั้น
          โดยเฉพาะในยุค 4.0 นี้ การตลาดอยู่ในโลกออนไลน์
          ที่มีผู้คนนับไม่ถ้วนที่เห็นสินค้าผ้าทอมือของเรา หากบริหารจัดการความรู้
          ความสามารถ และเวลาได้อย่างเหมาะสมแล้ว
          ศักยภาพในการค้าขายผ้าทอมือก็จะสมบูรณ์ยิ่งขึ้นอย่างน่าสนใจ
        </p>
      </section>
    </div>
  </div>
</template>
